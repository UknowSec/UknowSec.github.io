<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Ubuntu 14.10远程登录服务器--ssh的安装和配置 · Uknow - Stay hungry Stay foolish</title><meta name="description" content="Ubuntu 14.10远程登录服务器--ssh的安装和配置 - uknow"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/2.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div id="mask" style="display: none;"><img id="mask-image" src="#" style=" "></div><div class="wrap"><header><a href="/" class="logo-link"><img src="/2.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">Blog</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">Archive</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="https://github.com/uknowsec" target="_blank" class="nav-list-link">GitHub</a></li><li class="nav-list-item"><a href="http://weibo.com/uknowsec" target="_blank" class="nav-list-link">Weibo</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Ubuntu 14.10远程登录服务器--ssh的安装和配置</h1><div class="post-time">Feb 24, 2017</div><div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>ssh是一种安全协议，主要用于给远程登录会话数据进行加密，保证数据传输的安全，现在在需怒江Ubuntu 14.04环境下安装和配置ssh。</p>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><h3 id="更新源列表"><a href="#更新源列表" class="headerlink" title="更新源列表"></a>更新源列表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
<p><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/QQ%E5%9B%BE%E7%89%8720170224181454.png" alt=""></p>
<h3 id="安装ssh"><a href="#安装ssh" class="headerlink" title="安装ssh"></a>安装ssh</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openssh-server</span><br></pre></td></tr></table></figure>
<p>执行命令出现如下情况，按照提示貌似需要安装openshh-client和ssh-import-id<br><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/QQ%E6%88%AA%E5%9B%BE20170224182359.jpg" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openshh-client</span><br><span class="line">sudo apt-get install ssh-import-id</span><br></pre></td></tr></table></figure>
<p>安装完openshh-client和ssh-import-id后还是显示错误</p>
<p><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/QQ%E6%88%AA%E5%9B%BE20170224183037.jpg" alt=""></p>
<p>然后得知Ubuntu自带的openssh-clien与所要安装的openssh-server所依赖的版本不同,这里所依赖的版本是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1:6.6p1-2ubuntu2.8</span><br></pre></td></tr></table></figure></p>
<p>所以要安装降级安装低版本的openssh-clien，来覆盖Ubuntu自带的openssh-clien版本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openssh-client=1:6.6p1-2ubuntu1</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">uknow@uknow-ubuntu:~$ sudo apt-get install openssh-client=1:6.6p1-2ubuntu1</span><br><span class="line">正在读取软件包列表... 完成</span><br><span class="line">正在分析软件包的依赖关系树       </span><br><span class="line">正在读取状态信息... 完成       </span><br><span class="line">下列软件包是自动安装的并且现在不需要了：</span><br><span class="line">  apparmor-easyprof apparmor-easyprof-ubuntu click click-apparmor</span><br><span class="line">  gir1.2-click-0.4 gir1.2-gee-0.8 libclick-0.4-0 libcolord1</span><br><span class="line">  libgnome-desktop-3-7 libgtop2-7 liblttng-ust-ctl2 liblttng-ust0</span><br><span class="line">  libupstart-app-launch2 liburcu1 python3-apparmor python3-apparmor-click</span><br><span class="line">  python3-click python3-libapparmor upstart-app-launch</span><br><span class="line">  upstart-app-launch-tools</span><br><span class="line">Use &apos;apt-get autoremove&apos; to remove them.</span><br><span class="line">建议安装的软件包：</span><br><span class="line">  libpam-ssh keychain monkeysphere</span><br><span class="line">下列软件包将被【降级】：</span><br><span class="line">  openssh-client</span><br><span class="line">升级了 0 个软件包，新安装了 0 个软件包，降级了 1 个软件包，要卸载 0 个软件包，有 7 个软件包未被升级。</span><br><span class="line">需要下载 566 kB 的软件包。</span><br><span class="line">解压缩后将会空出 54.3 kB 的空间。</span><br><span class="line">您希望继续执行吗？ [Y/n] </span><br><span class="line">获取：1 http://ftp.cuhk.edu.hk/pub/Linux/ubuntu/ trusty/main openssh-client amd64 1:6.6p1-2ubuntu1 [566 kB]</span><br><span class="line">下载 566 kB，耗时 1秒 (419 kB/s)        </span><br><span class="line">dpkg：警告：downgrading openssh-client from 1:6.6p1-8 to 1:6.6p1-2ubuntu1</span><br><span class="line">(正在读取数据库 ... 系统当前共安装有 171295 个文件和目录。)</span><br><span class="line">Preparing to unpack .../openssh-client_1%3a6.6p1-2ubuntu1_amd64.deb ...</span><br><span class="line">Unpacking openssh-client (1:6.6p1-2ubuntu1) over (1:6.6p1-8) ...</span><br><span class="line">Processing triggers for man-db (2.7.0.2-2) ...</span><br></pre></td></tr></table></figure>
<p>可以看到,提示了系统中openssh-client被降级</p>
<p>再安装openssh-server就可以成功了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo  apt-get install openssh-server</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">uknow@uknow-ubuntu:~$ sudo  apt-get install openssh-server</span><br><span class="line">正在读取软件包列表... 完成</span><br><span class="line">正在分析软件包的依赖关系树       </span><br><span class="line">正在读取状态信息... 完成       </span><br><span class="line">下列软件包是自动安装的并且现在不需要了：</span><br><span class="line">  apparmor-easyprof apparmor-easyprof-ubuntu click click-apparmor</span><br><span class="line">  gir1.2-click-0.4 gir1.2-gee-0.8 libclick-0.4-0 libcolord1</span><br><span class="line">  libgnome-desktop-3-7 libgtop2-7 liblttng-ust-ctl2 liblttng-ust0</span><br><span class="line">  libupstart-app-launch2 liburcu1 python3-apparmor python3-apparmor-click</span><br><span class="line">  python3-click python3-libapparmor upstart-app-launch</span><br><span class="line">  upstart-app-launch-tools</span><br><span class="line">Use &apos;apt-get autoremove&apos; to remove them.</span><br><span class="line">将会安装下列额外的软件包：</span><br><span class="line">  libck-connector0 ncurses-term openssh-client openssh-sftp-server</span><br><span class="line">建议安装的软件包：</span><br><span class="line">  libpam-ssh keychain monkeysphere rssh molly-guard</span><br><span class="line">下列【新】软件包将被安装：</span><br><span class="line">  libck-connector0 ncurses-term openssh-server openssh-sftp-server</span><br><span class="line">下列软件包将被升级：</span><br><span class="line">  openssh-client</span><br><span class="line">升级了 1 个软件包，新安装了 4 个软件包，要卸载 0 个软件包，有 7 个软件包未被升级。</span><br><span class="line">需要下载 1,173 kB 的软件包。</span><br><span class="line">解压缩后会消耗掉 3,344 kB 的额外空间。</span><br><span class="line">您希望继续执行吗？ [Y/n] </span><br><span class="line">获取：1 http://ftp.cuhk.edu.hk/pub/Linux/ubuntu/ trusty/main libck-connector0 amd64 0.4.5-3.1ubuntu2 [10.5 kB]</span><br><span class="line">获取：2 http://ftp.cuhk.edu.hk/pub/Linux/ubuntu/ trusty-security/main openssh-client amd64 1:6.6p1-2ubuntu2.8 [564 kB]</span><br><span class="line">获取：3 http://ftp.cuhk.edu.hk/pub/Linux/ubuntu/ trusty/main ncurses-term all 5.9+20140118-1ubuntu1 [243 kB]</span><br><span class="line">获取：4 http://ftp.cuhk.edu.hk/pub/Linux/ubuntu/ trusty-security/main openssh-sftp-server amd64 1:6.6p1-2ubuntu2.8 [34.2 kB]</span><br><span class="line">获取：5 http://ftp.cuhk.edu.hk/pub/Linux/ubuntu/ trusty-security/main openssh-server amd64 1:6.6p1-2ubuntu2.8 [322 kB]</span><br><span class="line">下载 1,173 kB，耗时 2秒 (470 kB/s)      </span><br><span class="line">正在预设定软件包 ...</span><br><span class="line">Selecting previously unselected package libck-connector0:amd64.</span><br><span class="line">(正在读取数据库 ... 系统当前共安装有 171295 个文件和目录。)</span><br><span class="line">Preparing to unpack .../libck-connector0_0.4.5-3.1ubuntu2_amd64.deb ...</span><br><span class="line">Unpacking libck-connector0:amd64 (0.4.5-3.1ubuntu2) ...</span><br><span class="line">Preparing to unpack .../openssh-client_1%3a6.6p1-2ubuntu2.8_amd64.deb ...</span><br><span class="line">Unpacking openssh-client (1:6.6p1-2ubuntu2.8) over (1:6.6p1-2ubuntu1) ...</span><br><span class="line">Selecting previously unselected package ncurses-term.</span><br><span class="line">Preparing to unpack .../ncurses-term_5.9+20140118-1ubuntu1_all.deb ...</span><br><span class="line">Unpacking ncurses-term (5.9+20140118-1ubuntu1) ...</span><br><span class="line">Selecting previously unselected package openssh-sftp-server.</span><br><span class="line">Preparing to unpack .../openssh-sftp-server_1%3a6.6p1-2ubuntu2.8_amd64.deb ...</span><br><span class="line">Unpacking openssh-sftp-server (1:6.6p1-2ubuntu2.8) ...</span><br><span class="line">Selecting previously unselected package openssh-server.</span><br><span class="line">Preparing to unpack .../openssh-server_1%3a6.6p1-2ubuntu2.8_amd64.deb ...</span><br><span class="line">Unpacking openssh-server (1:6.6p1-2ubuntu2.8) ...</span><br><span class="line">Processing triggers for man-db (2.7.0.2-2) ...</span><br><span class="line">Processing triggers for ufw (0.34~rc-0ubuntu4) ...</span><br><span class="line">Processing triggers for ureadahead (0.100.0-16) ...</span><br><span class="line">ureadahead will be reprofiled on next reboot</span><br><span class="line">正在设置 libck-connector0:amd64 (0.4.5-3.1ubuntu2) ...</span><br><span class="line">正在设置 openssh-client (1:6.6p1-2ubuntu2.8) ...</span><br><span class="line">正在设置 ncurses-term (5.9+20140118-1ubuntu1) ...</span><br><span class="line">正在设置 openssh-sftp-server (1:6.6p1-2ubuntu2.8) ...</span><br><span class="line">正在设置 openssh-server (1:6.6p1-2ubuntu2.8) ...</span><br><span class="line">Creating SSH2 RSA key; this may take some time ...</span><br><span class="line">Creating SSH2 DSA key; this may take some time ...</span><br><span class="line">Creating SSH2 ECDSA key; this may take some time ...</span><br><span class="line">Creating SSH2 ED25519 key; this may take some time ...</span><br><span class="line">ssh start/running, process 7136</span><br><span class="line">Processing triggers for libc-bin (2.19-10ubuntu2) ...</span><br><span class="line">Processing triggers for ufw (0.34~rc-0ubuntu4) ...</span><br><span class="line">Processing triggers for ureadahead (0.100.0-16) ...</span><br></pre></td></tr></table></figure>
<h3 id="ssh服务"><a href="#ssh服务" class="headerlink" title="ssh服务"></a>ssh服务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo ps -e |grep ssh       //查看ssh服务是否启动</span><br><span class="line">sudo service ssh start     //开启ssh服务</span><br><span class="line">sudo service ssh stop		//关闭ssh服务</span><br></pre></td></tr></table></figure>
<p><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/QQ%E6%88%AA%E5%9B%BE20170224183549.jpg" alt=""></p>
<h3 id="修改配置文件sshd-config"><a href="#修改配置文件sshd-config" class="headerlink" title="修改配置文件sshd_config"></a>修改配置文件sshd_config</h3><ul>
<li><p>使用gedit修改配置文件”/etc/ssh/sshd_config”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>
</li>
<li><p>将其中的PermitRootLogin改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PermitRootLogin yes</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/QQ%E5%9B%BE%E7%89%8720170224190101.png" alt=""></p>
<h3 id="利用Xshell连接"><a href="#利用Xshell连接" class="headerlink" title="利用Xshell连接"></a>利用Xshell连接</h3><ul>
<li>查看本机ip<br>注意物理机和虚拟机网络方式需要使用桥接模式<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/QQ%E6%88%AA%E5%9B%BE20170224190652.jpg" alt=""></p>
<ul>
<li><p>使用Xshell登录ubuntu<br><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/QQ%E6%88%AA%E5%9B%BE20170224190730.jpg" alt=""><br><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/QQ%E6%88%AA%E5%9B%BE20170224190741.jpg" alt=""><br><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/QQ%E6%88%AA%E5%9B%BE20170224190801.jpg" alt=""></p>
</li>
<li><p>xshell上利用ifconfig<br><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/QQ%E6%88%AA%E5%9B%BE20170224190844.jpg" alt=""></p>
</li>
</ul>
<p>至此，成功的配置好了ssh并成功利用Xshel连接。</p>
</div></article></div></section><footer><div class="paginator"><a href="/posts/linux/第三周-Ubuntu-16-10日常折腾二三事.html" class="prev">PREV</a><a href="/posts/linux/第一周-Ubuntu-14-10安装后的二三事.html" class="next">NEXT</a></div><div class="copyright"><p>© 2016 - 2019 <a href="https://uknowsec.cn">uknow</a>  Stay hungry,Stay foolish.</p></div></footer></div><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-115504647-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?225ebcce29d319519ac7c7690425d1d4";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>