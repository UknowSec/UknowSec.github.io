<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> PHP&JSON 学习笔记 · Uknow - Stay hungry Stay foolish</title><meta name="description" content="PHP&amp;JSON 学习笔记 - uknow"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/2.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div id="mask" style="display: none;"><img id="mask-image" src="#" style=" "></div><div class="wrap"><header><a href="/" class="logo-link"><img src="/2.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">Blog</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">Archive</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="https://github.com/uknowsec" target="_blank" class="nav-list-link">GitHub</a></li><li class="nav-list-item"><a href="http://weibo.com/uknowsec" target="_blank" class="nav-list-link">Weibo</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">PHP&JSON 学习笔记</h1><div class="post-time">Oct 18, 2017</div><div class="post-content"><h2 id="JSON介绍"><a href="#JSON介绍" class="headerlink" title="JSON介绍"></a>JSON介绍</h2><p>JSON(JavaScript Object Notation) 是一种轻量级的数据交换格式</p>
<h3 id="JSON格式"><a href="#JSON格式" class="headerlink" title="JSON格式"></a>JSON格式</h3><ul>
<li>1） 并列的数据之间用逗号（”, “）分隔。</li>
<li>2） 映射用冒号（”: “）表示。</li>
<li>3） 并列数据的集合（数组）用方括号(“[]”)表示。</li>
<li>4） 映射的集合（对象）用大括号（”{}”）表示</li>
</ul>
<h2 id="PHP-amp-JSON"><a href="#PHP-amp-JSON" class="headerlink" title="PHP&amp;JSON"></a>PHP&amp;JSON</h2><h3 id="JSON函数"><a href="#JSON函数" class="headerlink" title="JSON函数"></a>JSON函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>json_encode</td>
<td style="text-align:center">对变量进行 JSON 编码</td>
</tr>
<tr>
<td>json_decode</td>
<td style="text-align:center">对 JSON 格式的字符串进行解码，转换为 PHP 变量</td>
</tr>
</tbody>
</table>
<h4 id="json-encode"><a href="#json-encode" class="headerlink" title="json_encode"></a>json_encode</h4><p>PHP json_encode() 用于对变量进行 JSON 编码，该函数如果执行成功返回 JSON 数据，否则返回 FALSE 。</p>
<h5 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string json_encode ( $value [, $options = 0 ] )</span><br></pre></td></tr></table></figure>
<h5 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h5><ul>
<li>value: 要编码的值。该函数只对 UTF-8 编码的数据有效。</li>
<li>options:由以下常量组成的二进制掩码：JSON_HEX_QUOT, JSON_HEX_TAG, JSON_HEX_AMP, JSON_HEX_APOS, JSON_NUMERIC_CHECK,JSON_PRETTY_PRINT, JSON_UNESCAPED_SLASHES, JSON_FORCE_OBJECT</li>
</ul>
<h5 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h5><p>以下实例演示了如何将 PHP 数组转换为 JSON 格式数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   $arr = array(&apos;a&apos; =&gt; 1, &apos;b&apos; =&gt; 2, &apos;c&apos; =&gt; 3, &apos;d&apos; =&gt; 4, &apos;e&apos; =&gt; 5);</span><br><span class="line">   echo json_encode($arr);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上代码执行结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;a&quot;:1,&quot;b&quot;:2,&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5&#125;</span><br></pre></td></tr></table></figure>
<p>以下实例演示了如何将 PHP 对象转换为 JSON 格式数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   class Emp &#123;</span><br><span class="line">       public $name = &quot;&quot;;</span><br><span class="line">       public $hobbies  = &quot;&quot;;</span><br><span class="line">       public $birthdate = &quot;&quot;;</span><br><span class="line">   &#125;</span><br><span class="line">   $e = new Emp();</span><br><span class="line">   $e-&gt;name = &quot;sachin&quot;;</span><br><span class="line">   $e-&gt;hobbies  = &quot;sports&quot;;</span><br><span class="line">   $e-&gt;birthdate = date(&apos;m/d/Y h:i:s a&apos;, &quot;8/5/1974 12:20:03 p&quot;);</span><br><span class="line">   $e-&gt;birthdate = date(&apos;m/d/Y h:i:s a&apos;, strtotime(&quot;8/5/1974 12:20:03&quot;));</span><br><span class="line"></span><br><span class="line">   echo json_encode($e);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上代码执行结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;name&quot;:&quot;sachin&quot;,&quot;hobbies&quot;:&quot;sports&quot;,&quot;birthdate&quot;:&quot;08\/05\/1974 12:20:03 pm&quot;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="json-decode"><a href="#json-decode" class="headerlink" title="json_decode"></a>json_decode</h4><p>PHP json_decode() 函数用于对 JSON 格式的字符串进行解码，并转换为 PHP 变量。</p>
<h5 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mixed json_decode ($json [,$assoc = false [, $depth = 512 [, $options = 0 ]]])</span><br></pre></td></tr></table></figure>
<h5 id="参数-1"><a href="#参数-1" class="headerlink" title="参数"></a>参数</h5><ul>
<li>json_string: 待解码的 JSON 字符串，必须是 UTF-8 编码数据</li>
<li>assoc: 当该参数为 TRUE 时，将返回数组，FALSE 时返回对象。</li>
<li>depth: 整数类型的参数，它指定递归深度</li>
<li>options: 二进制掩码，目前只支持 JSON_BIGINT_AS_STRING 。</li>
</ul>
<h5 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h5><p>以下实例演示了如何解码 JSON 数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   $json = &apos;&#123;&quot;a&quot;:1,&quot;b&quot;:2,&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5&#125;&apos;;</span><br><span class="line"></span><br><span class="line">   var_dump(json_decode($json));</span><br><span class="line">   var_dump(json_decode($json, true));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上代码执行结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">object(stdClass)#1 (5) &#123;</span><br><span class="line">    [&quot;a&quot;] =&gt; int(1)</span><br><span class="line">    [&quot;b&quot;] =&gt; int(2)</span><br><span class="line">    [&quot;c&quot;] =&gt; int(3)</span><br><span class="line">    [&quot;d&quot;] =&gt; int(4)</span><br><span class="line">    [&quot;e&quot;] =&gt; int(5)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">array(5) &#123;</span><br><span class="line">    [&quot;a&quot;] =&gt; int(1)</span><br><span class="line">    [&quot;b&quot;] =&gt; int(2)</span><br><span class="line">    [&quot;c&quot;] =&gt; int(3)</span><br><span class="line">    [&quot;d&quot;] =&gt; int(4)</span><br><span class="line">    [&quot;e&quot;] =&gt; int(5)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="PHP-amp-JSON中文显示问题"><a href="#PHP-amp-JSON中文显示问题" class="headerlink" title="PHP&amp;JSON中文显示问题"></a>PHP&amp;JSON中文显示问题</h3><h4 id="PHP输出JSON格式"><a href="#PHP输出JSON格式" class="headerlink" title="PHP输出JSON格式"></a>PHP输出JSON格式</h4><p>把数组直接输出为JSON</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$arr = array(&apos;姓名&apos;=&gt;&apos;小李&apos;,&apos;年龄&apos;=&gt;&apos;18&apos;);</span><br><span class="line">$json = json_encode($arr);</span><br><span class="line">echo $json;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>输出的结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;\u59d3\u540d&quot;:&quot;\u5c0f\u674e&quot;,&quot;\u5e74\u9f84&quot;:&quot;18&quot;&#125;</span><br></pre></td></tr></table></figure>
<p>中文字符被编码成了Unicode</p>
<p>做如下处理，把输出结果匹配一下，把Unicode还原成了汉字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$arr = array(&apos;姓名&apos;=&gt;&apos;小李&apos;,&apos;年龄&apos;=&gt;&apos;18&apos;);</span><br><span class="line">$json = json_encode($arr);</span><br><span class="line">echo $json;</span><br><span class="line">echo &apos;&lt;/br&gt;&apos;;</span><br><span class="line">echo decodeUnicode($json);</span><br><span class="line"> </span><br><span class="line">function decodeUnicode($str)&#123;</span><br><span class="line">  return preg_replace_callback(&apos;/\\\\u([0-9a-f]&#123;4&#125;)/i&apos;,</span><br><span class="line">    create_function(</span><br><span class="line">      &apos;$matches&apos;,</span><br><span class="line">      &apos;return mb_convert_encoding(pack(&quot;H*&quot;, $matches[1]), &quot;UTF-8&quot;, &quot;UCS-2BE&quot;);&apos;</span><br><span class="line">    ),</span><br><span class="line">    $str);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>输出的结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;\u59d3\u540d&quot;:&quot;\u5c0f\u674e&quot;,&quot;\u5e74\u9f84&quot;:&quot;18&quot;&#125;</span><br><span class="line">&#123;&quot;姓名&quot;:&quot;小李&quot;,&quot;年龄&quot;:&quot;18&quot;&#125;</span><br></pre></td></tr></table></figure>
<p>同时PHP5.4版本，已经给Json新增了一个选项: JSON_UNESCAPED_UNICODE。加上这个选项后，就不会自动把中文编码了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$arr = array(&apos;姓名&apos;=&gt;&apos;小李&apos;,&apos;年龄&apos;=&gt;&apos;18&apos;);</span><br><span class="line">$json = json_encode($arr, JSON_UNESCAPED_UNICODE);</span><br><span class="line">echo $json;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>输出的结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;姓名&quot;:&quot;小李&quot;,&quot;年龄&quot;:&quot;18&quot;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="http://www.runoob.com/php/php-json.html" target="_blank" rel="noopener">PHP JSON | 菜鸟教程</a><br><a href="http://www.ruanyifeng.com/blog/2009/05/data_types_and_json.html" target="_blank" rel="noopener">数据类型和Json格式</a></p>
</div></article></div></section><footer><div class="paginator"><a href="/posts/notes/PHP-MVC开发框架学习笔记.html" class="prev">上一篇</a><a href="/posts/notes/Docker基础与实战.html" class="next">下一篇</a></div><div class="copyright"><p>© 2016 - 2018 <a href="https://uknowsec.cn">uknow</a>  Stay hungry,Stay foolish.</p></div></footer></div><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-115504647-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?225ebcce29d319519ac7c7690425d1d4";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>